<!DOCTYPE html>
<html>

<!-- inclusion of styles -->
        <link rel="stylesheet" href="stylesheets/d3.parcoords.css" />
        <link rel="stylesheet" href="stylesheets/d3.slider.css" />
        <link rel="stylesheet" href="stylesheets/styles.css" />

        <!--  inclusion of scripts -->
        <script src="//d3js.org/d3.v3.min.js" charset="utf-8"></script>
        <script type="text/javascript" src="js/d3.slider.js"></script>
        <script type="text/javascript" src="js/d3extension.js"></script>
        <script type="text/javascript" src="js/d3.parcoords.js"></script>
        <script type="text/javascript" src="js/polybrush.js"></script>
        <!--  <script type="text/javascript" src="js/numeric-1.2.6.min.js"></script> -->

        <script type="text/javascript" src="js/setupAssistent.js"></script>
        <script type="text/javascript" src="js/keyHandler.js"></script>
        <script type="text/javascript" src="js/avap.js"></script>
        <script type="text/javascript" src="js/avapContainer.js"></script>
        <script type="text/javascript" src="js/vizContainer.js"></script>
        <script type="text/javascript" src="js/legend.js"></script>
        <script type="text/javascript" src="js/dragManager.js"></script>
        <script type="text/javascript" src="js/sliderManager.js"></script>
        <script type="text/javascript" src="js/tooltipManager.js"></script>
        <script type="text/javascript" src="js/loadFile.js"></script>
        <script type="text/javascript" src="js/vec.js"></script>

        <script type="text/javascript" src="js/train.js"></script>
        <script type="text/javascript" src="js/settings.js"></script>

        <script src="opencpu/jquery-3.2.1.min.js"></script>
        <script src="opencpu/opencpu-0.5.js"></script>

    <head>
        <meta charset="utf-8">
        <title>Dual Radviz</title>

    </head>

<!-- function called to initialize the system -->
    <body id="main" onload="startRadviz()">

        <div id="fileSidenav" class="sidenav">
          <a href="javascript:void(0)" class="closebtn" onclick="closeNav('fileSidenav')">&times;</a>
          <input id="openFile" name="openFile" type="file" class="inputFile"
              accept="text/csv,text/comma-separated-values,text/tab-separated-values,text/plain,.csv,.tsv"
              onchange="handleFile(this.files, false)"/>
          <a href="" onclick="document.getElementById('openFile').click(); return false">Open file</a>
          <input id="openClassifiedFile" name="openClassifiedFile" type="file" class="inputFile"
              accept="text/csv,text/comma-separated-values,text/tab-separated-values,text/plain,.csv,.tsv"
              onchange="handleFile(this.files, true)"/>
          <a href="" onclick="document.getElementById('openClassifiedFile').click(); return false">Open classified file</a>
          <a href="#">About</a>
        </div>

        <div id="settingsSidenav" class="sidenav">
          <a href="javascript:void(0)" class="closebtn" onclick="closeNav('settingsSidenav')">&times;</a>
          <a href="#">
                <input type="checkbox" class="checkb" id="separateRadvz" onclick="toggleAcClassRadius(this.checked)"/>
                  Separate RadViz circles</a>
          <a href="#">
                <input type="checkbox" class="checkb" id="dynamicRvOpacity" checked onclick="toggleDynamicOpacity(this.checked)"/>
                  Dynamic Radviz opacity</a>

          <a href="javascript:increasePointSize()">Point size &uarr;</a>
          <a href="javascript:decreasePointSize()">Point size &darr;</a>
          <a href="javascript:increasePointOpacity()">Point opacity &uarr;</a>
          <a href="javascript:decreasePointOpacity()">Point opacity &darr;</a>
          <a href="#">About</a>
        </div>

        <div id="dataSidenav" class="sidenav">
          <a href="javascript:void(0)" class="closebtn" onclick="closeNav('dataSidenav')">&times;</a>
          <div id="dimensionSelector"></div>

          <a href="#">About</a>
        </div>

        <div id="trainSidenav" class="sidenav">
          <a href="javascript:void(0)" class="closebtn" onclick="closeNav('trainSidenav')">&times;</a>
          <a href="javascript:train(allData)">Train data</a>
          <a href="#">About</a>
        </div>

        <nav><ul>
            <li><a href="javascript:openNav('fileSidenav')">File</a></li>
            <li><a href="javascript:openNav('settingsSidenav')">Settings</a></li>
            <li><a href="javascript:openNav('dataSidenav')">Data</a></li>
            <li><a href="javascript:openNav('trainSidenav')">Training</a></li>
            <li><a href="#">About</a></li>
            </ul>
        </nav>
        <div class="body">
            <div class=mainHeader>
                <div id="classContribSlider">
                    <h4><span id="contribution">Class: 0% / Attributes: 100%</span></h4>
                </div>
            </div>

            <div id="chart"></div>
            <div id="parc" class="parcoords"></div>
        </div>

        <script>
            var sa = new SetupAssistent();
            var vc = new VizContainer();

            var headersAttr = [];

            var classIndex;

            var curSidebar = 0;
            var isFileClassified = true;

            var headersClass = [];
            var classNames = [];
            var parcoords;
            var allData;
            var sliderConfigured;
            var colorAll = true;
            var PI = Math.PI;
            var TWO_PI = PI * 2;

            svgContainer = sa.getSvgContainer();

            function startRadviz(fileName) {

                if(fileName == undefined) {
                    fileName = sa.defaultFile;
                }

                vc.createAcApContainers();
                vc.colorScheme = sa.getClassColorScheme();

                console.log(fileName);

                d3.csv(fileName, function (csv) {
                    useFile(csv);
                });
            }

            function addDimensionFields(){
                // Container <div> where dynamic content will be placed
                var container = document.getElementById("dimensionSelector");
                // Clear previous contents of the container
                while (container.hasChildNodes()) {
                    container.removeChild(container.lastChild);
                }
                var avaps = vc.acAttr.avap;
                for (i=0; i<avaps.length; i++){
                    // Append a node with a random text
                    //container.appendChild(document.createTextNode("Member " + avaps[i].key));
                    // Create an <input> element, set its type and name attributes
                    var a = document.createElement("a");
                    a.value = i;
                    a.href = "javascript:vc.acAttr.toggleAvap("+i+")";
                    a.innerHTML = avaps[i].key;
                    if(avaps[i].enabled)
                        a.classList.add("enabled");
                    a.id = avaps[i].key;
                    //a.onclick =

                    //input.name = "member" + i;
                    container.appendChild(a);
                    // Append a line break
                    //container.appendChild(document.createElement("br"));
                }
            }
            /* Set the width of the side navigation to 250px */
            function openNav(id) {
                if(curSidebar == id){
                    closeNav(id);
                }
                else {
                    if(curSidebar)
                        document.getElementById(curSidebar).style.width = "0";

                    curSidebar = id;
                    document.getElementById(id).style.width = "250px";
                    document.getElementById("main").style.marginRight = "250px";
                }
            }

            /* Set the width of the side navigation to 0 */
            function closeNav(id) {
                curSidebar = 0;
                document.getElementById(id).style.width = "0";
                document.getElementById("main").style.marginRight = "0";
            }
        </script>
    </body>
</html>
